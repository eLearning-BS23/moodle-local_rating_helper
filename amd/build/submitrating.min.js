define ("local_rating_helper/submitrating",["jquery","core/notification","core/ajax","core/str"],function(a,b,c){function d(d){try{c.call([{methodname:"get_indivisual_rating",args:{cmid:d}}])[0].done(function(c){if(!0==c.success){a("#five-star").html(c.rated5);a("#four-star").html(c.rated4);a("#three-star").html(c.rated3);a("#two-star").html(c.rated2);a("#one-star").html(c.rated1)}else{b.addNotification({message:c.result,type:"error"})}}).fail(b.exception)}catch(a){}}function e(d){try{c.call([{methodname:"get_all_ratings",args:{cmid:d}}])[0].done(function(c){if(!0==c.success){var d="";if(0<c.ratings.length){c.ratings.forEach(function(a){d+="<div class=\"middle-last-part\">                            <div class=\"person-rating\">                                <div class=\"person\">"+a.profilepicture+"                                </div>                                <p class=\"person-name\">"+a.firstname+" "+a.lastname+"</p>                                <span class=\"date\">"+a.ratingdate+"</span>                            </div>                            <div class=\"person-comment\">                                <p class=\"comment-of-person\"> "+a.comment+"                                </p>                                <div class=\"star-rate\">                                    <h5 class=\"star-head\"> "+f(a.rating)+"                                    </h5>                                </div>                            </div>                        </div>"});a("#total-rating").html(c.ratings.length)}else{a("#total-rating").html("0");d+="No Rating Found"}a("#user-ratings").html(d)}else{b.addNotification({message:c.result,type:"error"})}}).fail(b.exception)}catch(a){}}function f(a){for(var b="",c=0;c<a;c++){b+="<i class=\"far fa-star star-icon-rate\" aria-hidden=\"true\"></i>"}return b}function g(d){try{c.call([{methodname:"get_cm_rating",args:{cmid:d}}])[0].done(function(c){if(!0==c.success){var d="";if(c.rating){for(var e=Math.round(c.rating).toFixed(1),f=0;f<Math.round(c.rating);f++){d+="<i class=\"far fa-star star-icon\"></i>"}}else{var e="0.0";d+="<i class=\"star-icon\">No rating found</i>"}a("#avg_rating").html(e);a("#avg_ret_star").html(d)}else{b.addNotification({message:c.result,type:"error"})}}).fail(b.exception)}catch(a){}}return{init:function init(f,h){g(f);d(f);e(f);a(document).on("click","#submit_rating_form",function(){var i=a("input[name=\"star\"]:checked").val(),j=a("#comment").val();if(i==void 0){b.addNotification({message:"rating field is required",type:"error"});return!1}try{c.call([{methodname:"save_rating",args:{userid:h,cmid:f,rating:i,comment:j}}])[0].done(function(c){if(1==c.success){a("input[name=\"star\"]").prop("checked",!1);a("#rating-form").addClass("d-none");g(f);d(f);e(f);b.addNotification({message:c.result,type:"success"})}else{b.addNotification({message:c.result,type:"error"})}}).fail(b.exception)}catch(a){}})}}});
//# sourceMappingURL=submitrating.min.js.map
