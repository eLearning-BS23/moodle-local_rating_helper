define ("local_rating_helper/submitrating",["jquery","core/str","core/notification","core/ajax"],function(a,b,c,d){function e(b){try{d.call([{methodname:"get_indivisual_rating",args:{cmid:b}}])[0].done(function(b){if(!0==b.success){a("#five-star").html(b.rated5);a("#four-star").html(b.rated4);a("#three-star").html(b.rated3);a("#two-star").html(b.rated2);a("#one-star").html(b.rated1)}}).fail(c.exception)}catch(a){}}function f(b){try{d.call([{methodname:"get_all_ratings",args:{cmid:b}}])[0].done(function(b){if(!0==b.success){var d="";if(0<b.ratings.length){b.ratings.forEach(function(a){var b=new Date(a.ratingdate);d+="<div class=\"middle-last-part\"><div class=\"person-rating\">    <div class=\"person\">"+a.profilepicture+"    </div>    <p class=\"person-name\">"+a.firstname+" "+a.lastname+"</p>    <span class=\"date\">"+b.toLocaleString()+"</span></div><div class=\"person-comment\">    <p class=\"comment-of-person\"> "+a.comment+"    </p>    <div class=\"star-rate\">        <h5 class=\"\"> "+g(a.rating)+"        </h5>    </div></div></div>"});a("#total-rating").html(b.ratings.length)}else{a("#total-rating").html("0");d+="No Rating Found"}a("#user-ratings").html(d)}else{c.addNotification({message:b.result,type:"error"})}}).fail(c.exception)}catch(a){}}function g(a){for(var b="",c=0;c<a;c++){b+="<svg width=\"21\" height=\"20\" viewBox=\"0 0 21 20\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M3.58266 18.5634C3.48541 19.1178 4.03237 19.5517 4.51542 19.3034L10.002 16.4835L15.4885 19.3034C15.9715 19.5517 16.5185 19.1178 16.4212 18.5634L15.3841 12.6516L19.787 8.45578C20.1985 8.06366 19.9855 7.34671 19.4342 7.2684L13.3111 6.39856L10.581 0.990381C10.3351 0.503206 9.66885 0.503206 9.42291 0.990381L6.69276 6.39856L0.569668 7.2684C0.0184315 7.34671 -0.194569 8.06366 0.216907 8.45578L4.61982 12.6516L3.58266 18.5634ZM9.71342 15.1033L5.10623 17.4712L5.97405 12.5246C6.01495 12.2915 5.93803 12.0527 5.77061 11.8931L2.13706 8.4305L7.20245 7.71092C7.41184 7.68117 7.59468 7.54743 7.69346 7.35176L10.002 2.77884L12.3104 7.35176C12.4092 7.54743 12.5921 7.68117 12.8015 7.71092L17.8668 8.4305L14.2333 11.8931C14.0659 12.0527 13.989 12.2915 14.0299 12.5246L14.8977 17.4712L10.2905 15.1033C10.1085 15.0097 9.89541 15.0097 9.71342 15.1033Z\" fill=\"#9CA4B6\"/></svg>"}return b}function h(b){try{d.call([{methodname:"get_cm_rating",args:{cmid:b}}])[0].done(function(b){if(!0==b.success){var d="";if(b.rating){for(var e=Math.round(b.rating).toFixed(1),f=0;f<Math.round(b.rating);f++){d+="<svg width=\"41\" height=\"38\" viewBox=\"0 0 41 38\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M7.16533 36.1269C6.97083 37.2355 8.06474 38.1033 9.03084 37.6068L20.0039 31.9669L30.977 37.6068C31.9431 38.1033 33.037 37.2355 32.8425 36.1269L30.7682 24.3032L39.574 15.9116C40.3969 15.1273 39.971 13.6934 38.8685 13.5368L26.6223 11.7971L21.162 0.980762C20.6701 0.00641251 19.3377 0.00641251 18.8458 0.980762L13.3855 11.7971L1.13934 13.5368C0.036863 13.6934 -0.389137 15.1273 0.433814 15.9116L9.23964 24.3032L7.16533 36.1269ZM19.4268 29.2065L10.2125 33.9425L11.9481 24.0493C12.0299 23.5829 11.8761 23.1053 11.5412 22.7863L4.27413 15.861L14.4049 14.4218C14.8237 14.3623 15.1894 14.0949 15.3869 13.7035L20.0039 4.55769L24.6209 13.7035C24.8185 14.0949 25.1841 14.3623 25.6029 14.4218L35.7337 15.861L28.4666 22.7863C28.1317 23.1053 27.9779 23.5829 28.0597 24.0493L29.7954 33.9425L20.581 29.2065C20.217 29.0195 19.7908 29.0195 19.4268 29.2065Z\" fill=\"#9CA4B6\"/></svg>"}}else{var e="0.0";d+="<i class=\"star-icon\">No rating found</i>"}a("#avg_rating").html(e);a("#avg-course-ret").html(g(e));a("#avg_ret_star").html(d)}else{c.addNotification({message:b.result,type:"error"})}}).fail(c.exception)}catch(a){}}return{init:function init(g,i){h(g);e(g);f(g);a(document).on("click","#submit_rating_form",function(){var j=a("input[name=\"star\"]:checked").val(),k=a("#comment").val();if(j==void 0){b.get_string("ratingfailed","local_rating_helper").then(function(a){c.addNotification({message:a,type:"error"})}).catch(Notification.exception);return!1}try{d.call([{methodname:"save_rating",args:{userid:i,cmid:g,rating:j,comment:k}}])[0].done(function(b){if(1==b.success){a("input[name=\"star\"]").prop("checked",!1);a("#rating-form").addClass("d-none");h(g);e(g);f(g);c.addNotification({message:b.result,type:"success"})}else{c.addNotification({message:b.result,type:"error"})}}).fail(c.exception)}catch(a){}})}}});
//# sourceMappingURL=submitrating.min.js.map
